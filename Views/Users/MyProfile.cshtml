@section Scripts {
    <script>
        $(document).ready(function() {
            function handleSubscriptionError() {
                alert('Произошла ошибка. Пожалуйста, попробуйте позже.');
            }

            function handleGroupUnsubscribe(btn) {
                var groupId = btn.data('group-id');
                btn.prop('disabled', true);

                $.post('/Groups/Unsubscribe', { groupId: groupId })
                    .done(function(response) {
                        if (response.success) {
                            btn.closest('.group-item').remove();
                        } else {
                            handleSubscriptionError();
                        }
                    })
                    .fail(handleSubscriptionError)
                    .always(function() {
                        btn.prop('disabled', false);
                    });
            }

            $('.unsubscribe-btn').click(function(e) {
                e.preventDefault();
                handleGroupUnsubscribe($(this));
            });
        });
    </script>
} 